<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ–ª–µ–≥—Ä–∞–º-–∫–∞–Ω–∞–ª –∞–¥–≤–æ–∫–∞—Ç–∞ –í–∞–ª–µ—Ä–∏—è –§–µ–¥–æ—Ä–æ–≤–∞</title>
    <style>
        :root {
            --bg: #f4f4f5;
            --card: #fff;
            --accent: #2AABEE;
            --accent2: #1a8fd1;
            --text: #1a1a1a;
            --muted: #8e8e93;
            --border: #e5e5ea;
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg); color: var(--text); -webkit-font-smoothing: antialiased;
        }

        .header {
            background: linear-gradient(135deg,#2AABEE,#1b8ec7);
            color:#fff; padding:24px 16px; text-align:center;
            position:sticky; top:0; z-index:9000;
            box-shadow:0 2px 12px rgba(0,0,0,.15);
        }
        .header h1 { font-size:21px; font-weight:700; }
        .header-sub { font-size:13px; opacity:.85; margin-top:3px; }
        .header-sub a { color:#fff; text-decoration:underline dashed; text-underline-offset:3px; }

        .wrap { max-width:680px; margin:0 auto; padding:14px 10px 50px; }

        .toolbar { display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-bottom:14px; }
        .search {
            flex:1; min-width:160px; padding:9px 13px; font-size:14px;
            border:1px solid var(--border); border-radius:10px; outline:none;
            background:var(--card); transition:border-color .2s,box-shadow .2s;
        }
        .search:focus { border-color:var(--accent); box-shadow:0 0 0 3px rgba(42,171,238,.12); }
        .info { font-size:12px; color:var(--muted); white-space:nowrap; }

        .status { text-align:center; padding:50px 20px; }
        .spinner {
            width:34px; height:34px; margin:0 auto 12px;
            border:3.5px solid var(--border); border-top-color:var(--accent);
            border-radius:50%; animation:sp .7s linear infinite;
        }
        @keyframes sp { to{transform:rotate(360deg)} }
        .status p { color:var(--muted); font-size:14px; }
        .status .err { color:#d9534f; }
        .retry { margin-top:12px; padding:9px 22px; font-size:14px; background:var(--accent); color:#fff; border:none; border-radius:8px; cursor:pointer; }

        .card {
            background:var(--card); border-radius:12px; margin-bottom:12px;
            padding:16px 18px; box-shadow:0 1px 4px rgba(0,0,0,.06);
            transition:box-shadow .2s; word-break:break-word;
        }
        .card:hover { box-shadow:0 4px 16px rgba(0,0,0,.1); }
        .card-head { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
        .card-date { font-size:12px; color:var(--muted); }
        .card-link { font-size:12px; color:var(--accent); text-decoration:none; }
        .card-link:hover { text-decoration:underline; }

        .card-body { font-size:15px; line-height:1.72; }
        .card-body a { color:var(--accent); text-decoration:none; }
        .card-body a:hover { text-decoration:underline; }
        .card-body b,.card-body strong { font-weight:600; }
        .card-body blockquote { border-left:3px solid var(--accent); margin:8px 0; padding:4px 14px; background:#f8f9fa; border-radius:0 8px 8px 0; }
        .card-body pre { background:#f4f4f4; padding:10px; border-radius:6px; overflow-x:auto; font-size:13px; margin:8px 0; }
        .card-body code { background:#f0f0f0; padding:1px 5px; border-radius:3px; font-size:13px; }

        .card-photo { margin-top:10px; border-radius:8px; overflow:hidden; line-height:0; cursor:pointer; }
        .card-photo img { width:100%; display:block; border-radius:8px; }
        .card-video { margin-top:10px; }
        .card-video video { width:100%; display:block; border-radius:8px; }

        .card-views { display:flex; align-items:center; gap:4px; margin-top:8px; font-size:12px; color:#bbb; }
        .card-views svg { width:14px; height:14px; fill:#bbb; }

        .btn-more {
            display:none; width:100%; padding:12px; margin-top:4px; font-size:14px;
            color:var(--accent); background:var(--card); border:1px solid var(--border);
            border-radius:10px; cursor:pointer; transition:all .2s;
        }
        .btn-more:hover { background:var(--accent); color:#fff; border-color:var(--accent); }

        .btn-top {
            position:fixed; bottom:22px; right:22px; width:44px; height:44px;
            background:var(--accent); color:#fff; border:none; border-radius:50%;
            font-size:20px; cursor:pointer; box-shadow:0 2px 10px rgba(0,0,0,.18);
            opacity:0; pointer-events:none; transition:opacity .25s; z-index:999;
            display:flex; align-items:center; justify-content:center;
        }
        .btn-top.show { opacity:1; pointer-events:auto; }

        .lb {
            position:fixed; inset:0; background:rgba(0,0,0,.9); z-index:99999;
            display:none; align-items:center; justify-content:center; cursor:zoom-out;
        }
        .lb.open { display:flex; }
        .lb img { max-width:95vw; max-height:95vh; border-radius:6px; }

        .empty { text-align:center; padding:40px 20px; color:var(--muted); font-size:14px; }
        .footer { text-align:center; padding:10px 20px 30px; font-size:11px; color:#bbb; }
        .footer a { color:var(--accent); text-decoration:none; }
        mark { background:#fff3cd; padding:0 2px; border-radius:2px; }

        @media(max-width:520px){
            .header{padding:18px 12px} .header h1{font-size:18px}
            .card{padding:13px 14px;border-radius:10px} .wrap{padding:10px 6px 40px}
        }
    </style>
</head>
<body>

<header class="header">
    <h1>üì¢ –¢–µ–ª–µ–≥—Ä–∞–º-–∫–∞–Ω–∞–ª –∞–¥–≤–æ–∫–∞—Ç–∞ –í–∞–ª–µ—Ä–∏—è –§–µ–¥–æ—Ä–æ–≤–∞</h1>
    <div class="header-sub">–ü–æ—Å—Ç—ã –∏–∑ –∫–∞–Ω–∞–ª–∞ <a href="https://t.me/adv_vfedorov" target="_blank">@adv_vfedorov</a></div>
</header>

<main class="wrap">
    <div class="toolbar">
        <input class="search" id="q" type="text" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –ø–æ—Å—Ç–∞–º‚Ä¶">
        <span class="info" id="info"></span>
    </div>
    <div id="feed">
        <div class="status" id="loader"><div class="spinner"></div><p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å—Ç–æ–≤‚Ä¶</p></div>
    </div>
    <button class="btn-more" id="more">–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë</button>
</main>

<a href="#top" class="btn-top" id="top" onclick="scrollTo({top:0,behavior:'smooth'})">‚Üë</a>
<div class="lb" id="lb" onclick="this.classList.remove('open')"><img id="lbImg" src="" alt=""></div>
<div class="footer">–ò—Å—Ç–æ—á–Ω–∏–∫: <a href="https://t.me/adv_vfedorov" target="_blank">t.me/adv_vfedorov</a> ¬∑ –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</div>

<script>
(function(){
    const BATCH = 20;
    let posts=[], vis=[], shown=0, query='';

    const $f=document.getElementById('feed'),
          $l=document.getElementById('loader'),
          $i=document.getElementById('info'),
          $m=document.getElementById('more'),
          $q=document.getElementById('q'),
          $t=document.getElementById('top'),
          $lb=document.getElementById('lb'),
          $li=document.getElementById('lbImg');

    /* Load pre-scraped JSON */
    fetch('posts.json')
        .then(r=>{if(!r.ok)throw new Error(r.status);return r.json()})
        .then(data=>{
            posts=data.sort((a,b)=>b.id-a.id);
            $l.remove();
            if(!posts.length){$f.innerHTML='<div class="empty">–ü–æ—Å—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</div>';return;}
            doFilter();
        })
        .catch(e=>{
            $l.innerHTML=`<p class="err">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${e.message}</p>
                <button class="retry" onclick="location.reload()">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
                <p style="margin-top:14px"><a href="https://t.me/adv_vfedorov" target="_blank" style="color:var(--accent);font-size:13px">–û—Ç–∫—Ä—ã—Ç—å –∫–∞–Ω–∞–ª –≤ Telegram ‚Üí</a></p>`;
        });

    function doFilter(){
        const lq=query.toLowerCase();
        vis=lq?posts.filter(p=>strip(p.text).toLowerCase().includes(lq)):[...posts];
        shown=0; $f.innerHTML='';
        $i.textContent=vis.length+' –ø–æ—Å—Ç'+plu(vis.length);
        if(!vis.length){$f.innerHTML='<div class="empty">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';$m.style.display='none';return;}
        batch();
    }

    function batch(){
        const end=Math.min(shown+BATCH,vis.length);
        for(let i=shown;i<end;i++) $f.appendChild(mkCard(vis[i]));
        shown=end;
        $m.style.display=shown<vis.length?'block':'none';
        if(shown<vis.length) $m.textContent=`–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë (${vis.length-shown})`;
    }

    function mkCard(p){
        const el=document.createElement('div'); el.className='card';
        let body=p.text||'';
        if(query) body=hl(body,query);

        let media='';
        if(p.photo) media=`<div class="card-photo" onclick="openLb('${esc(p.photo)}')"><img src="${esc(p.photo)}" alt="" loading="lazy"></div>`;
        else if(p.video) media=`<div class="card-video"><video src="${esc(p.video)}" controls preload="none"></video></div>`;

        let foot='';
        if(p.views) foot=`<div class="card-views"><svg viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>${p.views}</div>`;

        const link=`https://t.me/adv_vfedorov/${p.id}`;
        el.innerHTML=`<div class="card-head"><span class="card-date">${fmtD(p.date)}</span><a class="card-link" href="${link}" target="_blank">–û—Ç–∫—Ä—ã—Ç—å ‚Üó</a></div>${body?`<div class="card-body">${body}</div>`:''}${media}${foot}`;
        return el;
    }

    function fmtD(s){if(!s)return'';const d=new Date(s);if(isNaN(d))return s;return d.toLocaleDateString('ru-RU',{day:'numeric',month:'long',year:'numeric',hour:'2-digit',minute:'2-digit'});}
    function strip(h){return(h||'').replace(/<[^>]*>/g,'');}
    function esc(s){return s.replace(/'/g,"\\'");}
    function hl(h,q){const e=q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),r=new RegExp(`(${e})`,'gi');return h.replace(/>([^<]*)</g,(f,t)=>'>'+t.replace(r,'<mark>$1</mark>')+'<');}
    function plu(n){const m=n%100;if(m>=11&&m<=19)return'–æ–≤';const l=n%10;if(l===1)return'';if(l>=2&&l<=4)return'–∞';return'–æ–≤';}

    window.openLb=function(s){$li.src=s;$lb.classList.add('open');};
    $m.onclick=batch;
    let deb;$q.addEventListener('input',()=>{clearTimeout(deb);deb=setTimeout(()=>{query=$q.value.trim();doFilter();},250);});
    addEventListener('scroll',()=>{$t.classList.toggle('show',scrollY>500);},{passive:true});
    document.addEventListener('keydown',e=>{if(e.key==='Escape')$lb.classList.remove('open');});
})();
</script>
</body>
</html>